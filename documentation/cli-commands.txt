ConeZ CLI Command Reference
============================

The CLI is available simultaneously on both USB Serial and Telnet (port
23). All output goes to both streams; input is accepted from either.
The Telnet server negotiates IAC WILL ECHO + WILL SGA so clients
operate in character mode with server-side echo.

The desktop simulator (see simulator.txt) supports a subset of these
commands in its console: ?, run, stop, open, dir, del, list, ren, param,
led, sensors, time, uptime, version, wasm. Hardware-only commands are
not available in the simulator.

Line editing: arrow keys, Home/End, Delete, Ctrl-A/E, Ctrl-U (clear).
Up/Down arrows navigate command history (32 entries on PSRAM boards,
1 entry on Heltec). Duplicate consecutive commands are suppressed.
File paths are auto-normalized (/ prepended if missing).


Quick Reference
---------------

  ?                                  Show help
  art                                Display ANSI traffic cone art
  clear / cls                        Clear screen
  config [set|unset|reset]           Show or change settings
  cp {src} {dst}                     Copy file
  cue [load|start|stop|status]       Cue timeline engine control
  debug [off | {source} [on|off]]    Show or set debug message types
  del {filename}                     Delete file
  dir [path]                         List files (optionally in subdirectory)
  edit {filename}                    Full-screen text editor
  game                               Conway's Game of Life
  gpio [set|out|in|read]             Show or control GPIO pins
  gps [info|set|save|restart|send]   Show GPS status or configure module
  help                               Show help (same as ?)
  hexdump {filename} [count]         Hex+ASCII dump of file (default 256 bytes)
  history                            Show command history
  led                                Show LED configuration
  list {filename}                    Show file contents
  load {filename}                    Receive file via serial (CTRL+Z to end)
  lora                               Show LoRa radio status
  mem                                Show heap memory stats
  mkdir {path}                       Create directory
  mv {oldname} {newname}             Rename/move file (alias for ren)
  param {id} {value}                 Set script parameter
  ps                                 Show task list and stack watermarks
  psram [test|freq]                  Show PSRAM status or run diagnostics
  reboot                             Reboot the device
  ren {oldname} {newname}            Rename file
  rmdir {path}                       Remove empty directory
  run {filename}                     Run script (.bas or .wasm)
  sensors                            Show sensor readings
  stop                               Stop running script
  tc                                 Show thread count per core
  time                               Show current date/time and source
  uptime                             Show system uptime
  ver                                Show firmware version (alias for version)
  version                            Show firmware version and board info
  wasm [status|info <file>]          WASM runtime status/info
  wifi                               Show WiFi status
  winamp                             Audio visualizer (LED effect)


Detailed Command Descriptions
-----------------------------

?
  Alias for the help display. Shows all available commands.

art
  Display an ANSI art traffic cone. Uses 256-color escapes.

clear / cls
  Clear the terminal screen. Requires ANSI terminal support.

cp {src} {dst}
  Copy a file on LittleFS.
  Example: cp /startup.bas /startup_backup.bas

config
  Show all current configuration settings. See documentation/config.txt
  for the full config system reference.

  config set section.key value
      Set a configuration value and save to flash.
      Debug settings take effect immediately; all others require reboot.
      Values with spaces are supported (e.g. config set wifi.ssid My Net).

  config unset section.key
      Revert a single key to its compiled default and save.

  config reset
      Delete /config.ini and revert all settings to compiled defaults.

cue
  Control the cue timeline engine for synchronized LED shows.

  cue load {filename}
      Load a binary .cue file from LittleFS.
      Example: cue load /show.cue

  cue start [ms]
      Start cue playback. With no argument, starts from now. With an
      offset in ms, treats playback as having started that many ms ago
      (useful for syncing to a track already in progress).

  cue stop
      Stop cue playback.

  cue status
      Show cue engine state: loaded file, playing/stopped, position.

debug
  With no arguments, shows the current on/off state of each debug source.

  debug off
      Turn off all debug message sources.

  debug {source}
      Turn on the named source. Equivalent to "debug {source} on".

  debug {source} on|off
      Enable or disable a specific source.

  Sources: SYSTEM, BASIC, WASM, COMMANDS, SHELL, GPS, GPS_RAW, LORA,
           LORA_RAW, FSYNC, WIFI, SENSORS, OTHER

game
  Conway's Game of Life on a 30x20 toroidal grid with RGB age-based
  coloring. Runs at ~10 FPS. Press any key to exit.

del {filename}
  Delete a file from LittleFS.
  Example: del /old_script.bas

dir [path]
  List all files and directories on LittleFS with sizes. Optionally
  specify a subdirectory to list only its contents.
  Examples: dir
            dir /scripts

edit {filename}
  Open the full-screen text editor for on-device script editing. Creates
  the file if it doesn't exist. Supports arrow key navigation, line
  editing, goto line (Ctrl-G), and save (Ctrl-S). Press Ctrl-Q to quit.
  Runs in the ShellTask and does not block hardware polling.
  Example: edit /startup.bas

gpio
  With no arguments, shows all GPIO pin states (direction and level).
  Only shows pins valid for the current board.

  gpio set <pin> <0|1>
      Set the output level of an already-configured output pin.

  gpio out <pin> <0|1>
      Configure pin as output and set its level.

  gpio in <pin> [up|down|none]
      Configure pin as input with optional pull-up/pull-down.
      Default is no pull if not specified.

  gpio read <pin>
      Read the digital level of a single pin.

gps
  With no arguments, shows GPS status: fix type, satellites, HDOP/VDOP/
  PDOP, position, altitude, speed, direction, time, PPS info.
  Only available on boards with GPS hardware.

  gps info
      Query GPS module firmware version and hardware model.
      Enable 'debug gps_raw' to see the module's response.

  gps set baud <rate>
      Set the GPS module's serial baud rate.
      Valid rates: 4800, 9600, 19200, 38400, 57600, 115200.
      Note: the firmware always connects at 9600 on boot.

  gps set rate <hz>
      Set the GPS position update rate.
      Valid rates: 1, 2, 4, 5, or 10 Hz.

  gps set mode <constellation>
      Set which satellite constellations to use.
      Options: gps, bds, glonass, gps+bds, gps+glonass, bds+glonass, all

  gps set nmea <sentences>
      Enable specific NMEA sentence types at 1/fix rate, disable others.
      Comma-separated list of: gga, gll, gsa, gsv, rmc, vtg, zda, ant,
      dhv, lps, utc, gst, tim.
      Example: gps set nmea gga,rmc,gsa

  gps save
      Save the current GPS module configuration to its internal flash.
      Without this, settings revert on GPS module power cycle.

  gps restart <type>
      Restart the GPS module.
      Types: hot (keep ephemeris), warm (keep almanac), cold (clear all),
      factory (reset to factory defaults).

  gps send <body>
      Send an arbitrary NMEA sentence to the GPS module. The checksum
      is computed and appended automatically. The body is everything
      between $ and * (exclusive).
      Example: gps send PCAS06,0

help
  Show all available commands. Same as ?.

hexdump {filename} [count]
  Show a hex+ASCII dump of a file. Default shows first 256 bytes.
  Optionally specify byte count.
  Examples: hexdump /test.wasm
            hexdump /data.bin 1024

history
  Show command history. On PSRAM boards, stores up to 32 commands in a
  ring buffer. On boards without PSRAM, stores only the most recent
  command. Up/Down arrows navigate history.

led
  Show LED strip configuration (number of LEDs per strip).
  Only available on boards with RGB LEDs.

list {filename}
  Print the contents of a file to the console.
  Example: list /startup.bas

load {filename}
  Receive a file over the serial connection line by line.
  Send CTRL+Z (0x1A) to end transmission and save the file.
  Example: load /new_script.bas

lora
  Show LoRa radio status: frequency, bandwidth, spreading factor,
  last RSSI and SNR.

mem
  Show heap memory: free bytes, minimum since boot, largest allocatable
  block. Also shows PSRAM summary if available.

mkdir {path}
  Create a directory on LittleFS.
  Example: mkdir /scripts

mv {oldname} {newname}
  Alias for ren. Rename or move a file on LittleFS.
  Example: mv /old.bas /new.bas

param {id} {value}
  Set a script parameter. Parameters are a 16-slot integer array shared
  between the main loop and running scripts (BASIC or WASM). BASIC reads
  them with GETPARAM(id); WASM reads them with get_param(id).
  Example: param 1 42

ps
  Show FreeRTOS task list with state, priority, core affinity, and
  minimum free stack (high water mark) for each known task.

psram
  With no arguments, shows PSRAM status: availability, SPI clock speed,
  total/used/free/contiguous bytes, allocation slot usage, and cache
  hit rate. Available on all boards (shows "not available" on boards
  without PSRAM hardware).

  The default output includes a 64-character allocation map where each
  character represents 128KB of PSRAM: - (free), + (partially used),
  * (fully allocated). ANSI colored when available.

  psram test
      Run a full PSRAM memory test with read/write verification and
      throughput benchmark. Temporarily frees the shell history ring
      buffer to get exclusive PSRAM access, then re-allocates it after.

  psram test forever
      Run the memory test in a loop until an error occurs or a key is
      pressed. Useful for burn-in testing.

  psram freq <MHz>
      Change the SPI clock frequency at runtime (5-80 MHz). Useful for
      benchmarking. Default is 40 MHz. Only available on boards with
      external SPI PSRAM (ConeZ PCB).

reboot
  Reboot the ESP32.

ren {oldname} {newname}
  Rename a file on LittleFS.
  Example: ren /old.bas /new.bas

rmdir {path}
  Remove an empty directory from LittleFS.
  Example: rmdir /scripts

run {filename}
  Run a script file. The file extension determines the runtime: .bas
  files run on the BASIC interpreter task, .wasm files run on the WASM
  interpreter task. Both tasks are unpinned (tskNO_AFFINITY) and run on
  whichever core has bandwidth. Only one script of each type can run at
  a time.
  Examples: run /test.bas
            run /rgb_cycle.wasm

sensors
  Show sensor readings: IMU (roll/pitch/yaw/acceleration), temperature,
  battery voltage, solar voltage. Available sensors depend on the board.

stop
  Stop the currently running script. Sets parameter 0 to 1 (checked by
  BASIC via GETPARAM(0)) and signals the WASM runtime to exit. WASM
  modules are also stopped automatically via the m3_Yield() hook.

tc
  Show the thread loop counter for each CPU core. Useful for checking
  that tasks are running.

time
  Show current date, time, day of week, time source (GPS+PPS, NTP, or
  none), and epoch milliseconds. Available on all boards â€” GPS boards
  use PPS-disciplined time, others fall back to NTP when WiFi is
  connected.

uptime
  Show time since boot in days, hours, minutes, seconds.

ver
  Alias for version.

version
  Show firmware project name, version, build date/time, and board type.

wasm
  Show WASM runtime status and module information.

  wasm status
      Show whether a WASM module is running and its file path.

  wasm info {filename}
      Show the size of a .wasm file on LittleFS.
      Example: wasm info /rgb_cycle.wasm

wifi
  Show WiFi status: SSID, connection state, IP address, RSSI.

winamp
  Audio visualizer LED effect. Displays a retro-style equalizer on
  LED strips. Press any key to exit.
